!function(){"use strict";var t,e,n,a,o,r,c,s,i,u,l,d,m,f,p={1370:function(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},6250:function(t,e,n){t.exports=n.p+"admin/img/sprite.svg"}},h={};function v(t){var e=h[t];if(void 0!==e)return e.exports;var n=h[t]={exports:{}};return p[t](n,n.exports,v),n.exports}v.m=p,v.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return v.d(e,{a:e}),e},v.d=function(t,e){for(var n in e)v.o(e,n)&&!v.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},v.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),v.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;v.g.importScripts&&(t=v.g.location+"");var e=v.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),v.p=t+"../"}(),v.b=document.baseURI||self.location.href,e=v(1370),n=v.n(e),a=new URL(v(6250),v.b),n()(a,{hash:"#sorting"}),n()(a,{hash:"#plus"}),n()(a,{hash:"#close_modal"}),o=function(t){var e=t.url,n=t.method,a=t.body;return fetch(e,{method:n,headers:{"Content-Type":"application/json"},body:a})},r=function(t){return o({url:t,method:"GET"}).then((function(t){if(200===t.status)return t.json();throw new Error(t.statusText)}))},c=function(t){var e=new Map,n=document.getElementById("typeItem"),a=function(t){var e=document.getElementById("tbody");e.textContent="",t.forEach((function(t){var n=document.createElement("tr");n.className="table__row",n.setAttribute("data-id",t.id),n.innerHTML='\n                <td class="table__id table__cell">'.concat(t.id,'</td>\n                <td class="table-type table__cell">').concat(t.type,'</td>\n                <td class="table-name table__cell">').concat(t.name,'</td>\n                <td class="table-units table__cell">').concat(t.units,'</td>\n                <td class="table-cost table__cell">').concat(t.cost,' руб</td>\n                <td>\n                    <div class="table__actions table__cell">\n                        <button class="button action-change"><span class="svg_ui">\n                            <svg class="action-icon_change">\n                                <use xlink:href="./img/sprite.svg#change"></use>\n                            </svg></span><span>Изменить</span>\n                        </button>\n                        <button class="button action-remove"><span class="svg_ui">\n                            <svg class="action-icon_remove">\n                                <use xlink:href="./img/sprite.svg#remove"></use>\n                            </svg></span><span>Удалить</span>\n                        </button>\n                    </div>\n                </td>\n            '),e.append(n)}))},o=function(t){var o;t.forEach((function(t){e.has(t.type)?e.get(t.type).push(t):e.set(t.type,[t])})),o=e.keys(),n.innerHTML='<option value="Все услуги">Все услуги</option>',Array.from(o).forEach((function(t){var e=document.createElement("option");e.value=t,e.textContent=t,n.append(e)})),a(Array.from(e.values()).flat())};n.addEventListener("change",(function(t){var n=t.target;e.get(n.value)?a(e.get(n.value)):a(Array.from(e.values()).flat())})),r(t+"/api/items").then((function(t){return o(t)})).catch((function(t){console.warn(t)}))},s=function(t,e,n,a){var r={};new FormData(n).forEach((function(t,e){r[e]=t})),n.reset(),o({url:t+e,method:a,body:JSON.stringify(r)}).then((function(e){if(200!==e.status&&201!==e.status)throw e;c(t)})).catch((function(t){422===t.status?alert("Введите корректные данные!"):alert("Ошибка сервера!")}))},i=function(t,e){o({url:"".concat(t,"/api/items/").concat(e),method:"DELETE"}).then((function(e){if(200!==e.status)throw new Error(e.statusText);c(t)})).catch((function(t){console.warn(t)}))},u=function(t,e,n){return t.forEach((function(t){n?t.classList.add(e):t.classList.remove(e)}))},l=function(t,e){r(t+"/api/items/"+e).then((function(t){return e=t,n=document.getElementById("new-item-form"),a=n.querySelector('input[name="type"]'),o=n.querySelector('input[name="name"]'),r=n.querySelector('input[name="units"]'),c=n.querySelector('input[name="cost"]'),s=document.getElementById("modal"),i=s.querySelector(".modal__header-change"),n.setAttribute("data-id",e.id),a.value=e.type,o.value=e.name,r.value=e.units,c.value=e.cost,void u([i,s],"show",!0);var e,n,a,o,r,c,s,i})).catch((function(t){alert("Ошибка: "+t)}))},d=function(t){var e=document.getElementById("modal"),n=e.querySelector(".modal__header-add"),a=e.querySelector(".modal__header-change");document.addEventListener("click",(function(o){var r=o.target,c=document.getElementById("new-item-form");r.closest(".btn-addItem")&&(c.setAttribute("data-action","add"),u([n,e],"show",!0)),(r.classList.contains("modal__overlay")||r.closest(".button__close"))&&(c.removeAttribute("data-action"),u([e,n,a],"show")),r.closest(".cancel-button")&&(o.preventDefault(),c.removeAttribute("data-action"),c.reset(),u([n,e],"show")),r.closest(".action-remove")&&confirm("Вы действительно хотите удалить услугу?")&&i(t,r.closest(".table__row").getAttribute("data-id")),r.closest(".action-change")&&(c.setAttribute("data-action","change"),l(t,r.closest(".table__row").getAttribute("data-id")))})),document.addEventListener("submit",(function(o){o.preventDefault();var r=o.target,c=r.getAttribute("data-action");u([e,n,a],"show"),"add"===c?s(t,"/api/items",r,"POST"):"change"===c&&s(t,"/api/items/".concat(r.dataset.id),r,"PATCH"),r.removeAttribute("data-action"),r.removeAttribute("data-id")}))},m="https://obscure-scrubland-21489.herokuapp.com",f=window.location.origin+"/relax-life",new RegExp("demo").test(document.cookie)||(t=f+"/admin",document.location.replace(t)),c(m),d(m)}();